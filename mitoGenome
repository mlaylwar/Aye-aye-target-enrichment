# Filter raw sequences to check for length, quality, and contaminant reads

# First filter the raw reads using PRINSEQlite and remove any reads that were less than 120bp in length. Don't clip reads as this affects duplicate removal

while read k
do

  for ((i=1; i<5; i++))
  do

  ~/Software/prinseq-lite-0.20.4/prinseq-lite -fastq "${k}/${k}_${i}_1.fastq" -fastq2 "${k}/${k}_${i}_2.fastq" -out_good Filtered/${k}/${k}_${i}_good -out_bad null -min_len 120 -min_qual_mean 20 -out_format 3
  done
done < mitoSampleList
